import{j as e}from"./ui--n0l2wTA.js";import{u as P,r as s}from"./vendor-BvJ-yVPi.js";import{a as E,T as C}from"./index-D4TU03tc.js";import{c as L,s as T}from"./news-Bh4GDCVc.js";import"./three-TYGphhMp.js";import"./icons-Bqiqei89.js";function A(){const d=P(),{user:t,signOut:p}=E(),[v,l]=s.useState(!0),[c,g]=s.useState(!1),[m,u]=s.useState(null),[x,y]=s.useState(null),[j,n]=s.useState(!1),[o,i]=s.useState([]),[h,b]=s.useState(""),k=["Technology","Business","Politics","Science","Health","Sports","Entertainment","World News"];s.useEffect(()=>{if(!t){d("/auth");return}(async()=>{l(!0),u(null);try{const{preferences:a,error:f}=await L(t.id);if(f)throw f;a&&(i(a.categories||[]),b(a.location||""))}catch(a){console.error("Error loading profile:",a),u("Failed to load your profile. Please try again.")}finally{l(!1)}})()},[t,d]);const N=r=>{o.includes(r)?i(o.filter(a=>a!==r)):i([...o,r])},w=async()=>{try{await p(),d("/")}catch(r){console.error("Error signing out:",r)}},S=async()=>{if(t){g(!0),y(null),n(!1);try{const{success:r,error:a}=await T(t.id,{categories:o,sources:[],location:h});if(!r)throw a;n(!0),setTimeout(()=>n(!1),3e3)}catch(r){console.error("Error saving preferences:",r),y("Failed to save your preferences. Please try again.")}finally{g(!1)}}};return v?e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-50 dark:bg-gray-900 transition-colors duration-200",children:e.jsx("div",{className:"w-12 h-12 border-t-2 border-primary border-solid rounded-full animate-spin"})}):e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 py-12 transition-colors duration-200",children:e.jsx("div",{className:"container mx-auto px-4",children:e.jsx("div",{className:"max-w-3xl mx-auto",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden transition-colors duration-200",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Your Profile"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(C,{}),e.jsx("button",{onClick:w,className:"px-4 py-2 text-sm text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300",children:"Sign Out"})]})]}),t&&e.jsx("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:t.email}),m&&e.jsx("div",{className:"mt-4 p-3 bg-red-50 dark:bg-red-900/30 text-red-500 dark:text-red-300 rounded-md",children:m})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Interests"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Select topics you're interested in to personalize your news feed."}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-8",children:k.map(r=>e.jsx("button",{onClick:()=>N(r),className:`p-3 rounded-md border text-center transition-colors ${o.includes(r)?"bg-primary text-white border-primary":"bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 border-gray-300 dark:border-gray-600 hover:border-primary dark:hover:border-primary"}`,children:r},r))}),e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Location"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Update your location to get relevant local news."}),e.jsx("div",{className:"mb-8",children:e.jsx("input",{type:"text",value:h,onChange:r=>b(r.target.value),placeholder:"City or zip code",className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"})}),x&&e.jsx("div",{className:"mt-4 mb-4 p-3 bg-red-50 dark:bg-red-900/30 text-red-500 dark:text-red-300 rounded-md",children:x}),j&&e.jsx("div",{className:"mt-4 mb-4 p-3 bg-green-50 dark:bg-green-900/30 text-green-600 dark:text-green-300 rounded-md",children:"Your preferences have been saved successfully!"}),e.jsxs("div",{className:"flex justify-end",children:[e.jsx("button",{onClick:()=>d("/feed"),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md mr-3 hover:bg-gray-50 dark:hover:bg-gray-700",children:"Cancel"}),e.jsx("button",{onClick:S,disabled:c,className:"px-4 py-2 bg-primary text-white rounded-md hover:bg-opacity-90 disabled:opacity-50 disabled:cursor-not-allowed",children:c?"Saving...":"Save Preferences"})]})]})]})})})})}export{A as default};

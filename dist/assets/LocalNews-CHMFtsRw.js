import{r as o,j as e,A as C,m as E}from"./vendor-Bm8ggWCn.js";import{u as T}from"./index-3l1SVbqs.js";import{g as k,a as F,c as R}from"./news-0YU1WGt2.js";import{A as _}from"./ArticleCard-AjvBVRyc.js";import{c as D,l as M,m as O,n as $}from"./ui-NjSizdhA.js";import"./three-ESLURWGF.js";function H(){const[b,j]=o.useState([]),[c,l]=o.useState(!0),[d,n]=o.useState(null),[r,m]=o.useState(1),[x,N]=o.useState(1),[a,w]=o.useState(null),[i,f]=o.useState(!1),{user:G}=T(),u=12;o.useEffect(()=>{(async()=>{f(!0);try{const s=await k();if(s){const p=await F(s.latitude,s.longitude);w(p),await h(p)}else n("Unable to get your location. Please allow location access for local news."),l(!1)}catch(s){console.error("Error getting location:",s),n("Failed to determine your location. Please ensure location services are enabled."),l(!1)}finally{f(!1)}})()},[]);const h=async t=>{try{l(!0);const s=await R("Local",t);j(s),N(Math.ceil(s.length/u))}catch(s){console.error("Error loading local articles:",s),n("Failed to load local news. Please try again later.")}finally{l(!1)}},v=async t=>{console.log("Save article:",t)},A=async t=>{console.log("Share article:",t)},L=()=>{r<x&&(m(r+1),window.scrollTo({top:0,behavior:"smooth"}))},P=()=>{r>1&&(m(r-1),window.scrollTo({top:0,behavior:"smooth"}))},y=r*u,S=y-u,g=b.slice(S,y);return d?e.jsx("div",{className:"flex items-center justify-center min-h-[50vh]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-semibold text-red-600 mb-2",children:"Error"}),e.jsx("p",{className:"text-muted-foreground",children:d}),e.jsx("button",{onClick:()=>{n(null),a&&h(a)},className:"mt-4 px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90",children:"Try Again"})]})}):e.jsxs("div",{className:"container mx-auto px-4 py-8 space-y-8",children:[e.jsx("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Local News"}),a&&e.jsxs("div",{className:"flex items-center mt-2 text-muted-foreground",children:[e.jsx(D,{className:"h-4 w-4 mr-1"}),e.jsxs("span",{children:[a.city?a.city:"",a.region?a.city?`, ${a.region}`:a.region:""]})]})]})}),(c||i)&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(M,{className:"h-10 w-10 animate-spin text-primary mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:i?"Determining your location...":"Loading local news..."})]}),!c&&!i&&g.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.jsx(C,{children:g.map(t=>e.jsx(E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:e.jsx(_,{article:t,onSave:v,onShare:A})},t.id))})}),e.jsxs("div",{className:"flex justify-center items-center mt-8 space-x-2",children:[e.jsx("button",{onClick:P,disabled:r===1,className:"p-2 rounded-md border border-gray-300 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(O,{className:"h-5 w-5"})}),e.jsx("div",{className:"flex items-center space-x-2",children:Array.from({length:x},(t,s)=>s+1).map(t=>e.jsx("button",{onClick:()=>{m(t),window.scrollTo({top:0,behavior:"smooth"})},className:`px-3 py-1 rounded-md ${r===t?"bg-primary text-white":"border border-gray-300 hover:bg-gray-100"}`,children:t},t))}),e.jsx("button",{onClick:L,disabled:r===x,className:"p-2 rounded-md border border-gray-300 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx($,{className:"h-5 w-5"})})]})]}),!c&&!i&&g.length===0&&!d&&e.jsx("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:e.jsxs("div",{className:"bg-gray-100 dark:bg-gray-800 p-8 rounded-lg max-w-md",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"No Local News Found"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"We couldn't find any local news for your current location. This could be because of limited coverage in your area."}),e.jsx("button",{onClick:()=>{a&&h(a)},className:"px-4 py-2 bg-primary text-white rounded-md hover:bg-primary/90",children:"Refresh"})]})})]})}export{H as default};

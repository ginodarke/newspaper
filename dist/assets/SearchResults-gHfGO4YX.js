import{r as c,j as e,h as R,u as C,A as E,m as L}from"./vendor-Bm8ggWCn.js";import{d as M,e as I}from"./news-y6q2ucae.js";import{L as z,A as T}from"./ArticleCard-Dh4eiFHY.js";import{C as B,E as V,d as F,n as _}from"./ui-OeHMmaS8.js";import"./index-DAs0h1ky.js";import"./three-CHCbE9v9.js";var S=new Map,b=new WeakMap,A=0,$=void 0;function D(s){return s?(b.has(s)||(A+=1,b.set(s,A.toString())),b.get(s)):"0"}function O(s){return Object.keys(s).sort().filter(r=>s[r]!==void 0).map(r=>`${r}_${r==="root"?D(s.root):s[r]}`).toString()}function P(s){const r=O(s);let n=S.get(r);if(!n){const d=new Map;let i;const l=new IntersectionObserver(t=>{t.forEach(a=>{var o;const u=a.isIntersecting&&i.some(x=>a.intersectionRatio>=x);s.trackVisibility&&typeof a.isVisible>"u"&&(a.isVisible=u),(o=d.get(a.target))==null||o.forEach(x=>{x(u,a)})})},s);i=l.thresholds||(Array.isArray(s.threshold)?s.threshold:[s.threshold||0]),n={id:r,observer:l,elements:d},S.set(r,n)}return n}function W(s,r,n={},d=$){if(typeof window.IntersectionObserver>"u"&&d!==void 0){const o=s.getBoundingClientRect();return r(d,{isIntersecting:d,target:s,intersectionRatio:typeof n.threshold=="number"?n.threshold:0,time:0,boundingClientRect:o,intersectionRect:o,rootBounds:o}),()=>{}}const{id:i,observer:l,elements:t}=P(n),a=t.get(s)||[];return t.has(s)||t.set(s,a),a.push(r),l.observe(s),function(){a.splice(a.indexOf(r),1),a.length===0&&(t.delete(s),l.unobserve(s)),t.size===0&&(l.disconnect(),S.delete(i))}}function H({threshold:s,delay:r,trackVisibility:n,rootMargin:d,root:i,triggerOnce:l,skip:t,initialInView:a,fallbackInView:o,onChange:u}={}){var x;const[h,N]=c.useState(null),g=c.useRef(u),[p,j]=c.useState({inView:!!a,entry:void 0});g.current=u,c.useEffect(()=>{if(t||!h)return;let y;return y=W(h,(k,w)=>{j({inView:k,entry:w}),g.current&&g.current(k,w),w.isIntersecting&&l&&y&&(y(),y=void 0)},{root:i,rootMargin:d,threshold:s,trackVisibility:n,delay:r},o),()=>{y&&y()}},[Array.isArray(s)?s.toString():s,h,i,d,l,t,n,o,r]);const m=(x=p.entry)==null?void 0:x.target,v=c.useRef(void 0);!h&&m&&!l&&!t&&v.current!==m&&(v.current=m,j({inView:!!a,entry:void 0}));const f=[N,p.inView,p.entry];return f.ref=f[0],f.inView=f[1],f.entry=f[2],f}function q({article:s,onSave:r,onShare:n,onClose:d}){const[i,l]=c.useState(null),[t,a]=c.useState(!1),[o,u]=c.useState("content"),x=async()=>{if(!(i||t)){a(!0);try{const h=await M(s);l(h)}catch(h){console.error("Error loading summary:",h)}finally{a(!1)}}};return e.jsx("div",{className:"p-6 bg-white dark:bg-gray-800 rounded-lg shadow-lg",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:s.category}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"â€¢"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:s.source})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(B,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[s.readTime," min read"]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(V,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[s.views," views"]})]})]})]}),e.jsx("h1",{className:"text-3xl font-bold",children:s.title}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("img",{src:s.author.avatar,alt:s.author.name,className:"h-10 w-10 rounded-full"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.author.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:new Date(s.publishedAt).toLocaleDateString()})]})]}),e.jsx("img",{src:s.imageUrl,alt:s.title,className:"w-full rounded-lg object-cover"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex border-b",children:[e.jsx("button",{className:`px-4 py-2 text-sm font-medium ${o==="content"?"border-b-2 border-primary text-primary":"text-muted-foreground hover:text-gray-700 dark:hover:text-gray-300"}`,onClick:()=>u("content"),children:"Content"}),e.jsx("button",{className:`px-4 py-2 text-sm font-medium ${o==="summary"?"border-b-2 border-primary text-primary":"text-muted-foreground hover:text-gray-700 dark:hover:text-gray-300"}`,onClick:()=>u("summary"),children:"AI Summary"})]}),o==="content"&&e.jsx("div",{className:"mt-4 prose prose-sm max-w-none",children:e.jsx("p",{children:s.content})}),o==="summary"&&e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsx("p",{className:"text-muted-foreground",children:s.aiSummary}),!i&&!t&&e.jsx("button",{className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium hover:bg-gray-100 dark:border-gray-600 dark:hover:bg-gray-700",onClick:x,children:"Load Full Summary"}),t&&e.jsx("p",{children:"Loading full summary..."}),i&&e.jsx("div",{className:"prose prose-sm max-w-none",children:e.jsx("p",{children:i})})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{className:"inline-flex items-center px-3 py-1 text-sm font-medium border border-gray-300 rounded-md hover:bg-gray-100 dark:border-gray-600 dark:hover:bg-gray-700",onClick:()=>r==null?void 0:r(s.id),children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),"Save"]}),e.jsxs("button",{className:"inline-flex items-center px-3 py-1 text-sm font-medium border border-gray-300 rounded-md hover:bg-gray-100 dark:border-gray-600 dark:hover:bg-gray-700",onClick:()=>n==null?void 0:n(s),children:[e.jsx(_,{className:"h-4 w-4 mr-2"}),"Share"]})]}),e.jsx("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-primary hover:underline",children:"Read original article"})]})]})})}function Y(){const{query:s}=R(),r=C(),[n,d]=c.useState([]),[i,l]=c.useState(!0),[t,a]=c.useState(null),[o,u]=c.useState(null),[x,h]=c.useState(null),{ref:N}=H();c.useEffect(()=>{if(!s){r("/");return}(async()=>{try{l(!0);const v=await I(s);d(v)}catch(v){console.error("Error searching articles:",v),a("Failed to fetch search results. Please try again later.")}finally{l(!1)}})()},[s,r]);const g=()=>{u(null)},p=async m=>{console.log("Save article:",m)},j=async m=>{console.log("Share article:",m)};return e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("h1",{className:"text-2xl font-bold mb-4",children:["Search Results: ",e.jsx("span",{className:"text-primary",children:s})]}),i&&e.jsx("div",{className:"flex justify-center py-20",children:e.jsx(z,{size:"large"})}),t&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-800 rounded-lg p-4 my-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})}),e.jsx("span",{children:t})]})}),!i&&!t&&n.length===0&&e.jsxs("div",{className:"text-center py-20",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1M19 20a2 2 0 002-2V8a2 2 0 00-2-2h-5a2 2 0 00-2 2v10a2 2 0 002 2h5zM2 10h8"})}),e.jsx("h3",{className:"mt-2 text-lg font-medium text-gray-900",children:"No results found"}),e.jsx("p",{className:"mt-1 text-gray-500",children:"Try different search terms or browse categories instead."})]}),!i&&!t&&n.length>0&&e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.jsx(E,{children:n.map(m=>e.jsx(L.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:e.jsx(T,{article:m,onSave:p,onShare:j})},m.id))})}),e.jsx("div",{ref:N,className:"h-10 mt-8"}),o&&e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto bg-black bg-opacity-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"relative w-full max-w-4xl bg-white rounded-lg shadow-xl",children:[e.jsx("button",{onClick:g,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx(q,{article:o,onClose:g})]})})]})}export{Y as default};

import{j as e}from"./ui--n0l2wTA.js";import{r}from"./vendor-BvJ-yVPi.js";import{b as C}from"./index-D4TU03tc.js";import{a as E}from"./news-Bh4GDCVc.js";import{g as k,a as T}from"./location-BtZiQxnz.js";import{A as F}from"./ArticleCard-ClAHm5AA.js";import{k as R,L as _,l as D,m as M}from"./icons-Bqiqei89.js";import{A as O,m as $}from"./animation-C8ivTUSO.js";import"./three-TYGphhMp.js";import"./utils-U3DZdfOV.js";function V(){const[b,j]=r.useState([]),[d,i]=r.useState(!0),[m,l]=r.useState(null),[o,x]=r.useState(1),[u,N]=r.useState(1),[a,w]=r.useState(null),[n,f]=r.useState(!1),{user:z}=C(),c=12;r.useEffect(()=>{(async()=>{f(!0);try{const s=await k();if(s){const p=await T(s.latitude,s.longitude);w(p),await h(p)}else l("Unable to get your location. Please allow location access for local news."),i(!1)}catch(s){console.error("Error getting location:",s),l("Failed to determine your location. Please ensure location services are enabled."),i(!1)}finally{f(!1)}})()},[]);const h=async t=>{try{i(!0);const s=await E({category:"Local",location:t,page:1,pageSize:c});j(s.articles),N(Math.ceil(s.totalResults/c))}catch(s){console.error("Error loading local articles:",s),l("Failed to load local news. Please try again later.")}finally{i(!1)}},v=async t=>{console.log("Save article:",t)},L=async t=>{console.log("Share article:",t)},A=()=>{o<u&&(x(o+1),window.scrollTo({top:0,behavior:"smooth"}))},S=()=>{o>1&&(x(o-1),window.scrollTo({top:0,behavior:"smooth"}))},y=o*c,P=y-c,g=b.slice(P,y);return m?e.jsx("div",{className:"flex items-center justify-center min-h-[50vh]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-semibold text-red-600 mb-2",children:"Error"}),e.jsx("p",{className:"text-muted-foreground",children:m}),e.jsx("button",{onClick:()=>{l(null),a&&h(a)},className:"mt-4 px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90",children:"Try Again"})]})}):e.jsxs("div",{className:"container mx-auto px-4 py-8 space-y-8",children:[e.jsx("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Local News"}),a&&e.jsxs("div",{className:"flex items-center mt-2 text-muted-foreground",children:[e.jsx(R,{className:"h-4 w-4 mr-1"}),e.jsxs("span",{children:[a.city?a.city:"",a.region?a.city?`, ${a.region}`:a.region:""]})]})]})}),(d||n)&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(_,{className:"h-10 w-10 animate-spin text-primary mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:n?"Determining your location...":"Loading local news..."})]}),!d&&!n&&g.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.jsx(O,{children:g.map(t=>e.jsx($.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:e.jsx(F,{article:t,onSave:v,onShare:L})},t.id))})}),e.jsxs("div",{className:"flex justify-center items-center mt-8 space-x-2",children:[e.jsx("button",{onClick:S,disabled:o===1,className:"p-2 rounded-md border border-gray-300 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(D,{className:"h-5 w-5"})}),e.jsx("div",{className:"flex items-center space-x-2",children:Array.from({length:u},(t,s)=>s+1).map(t=>e.jsx("button",{onClick:()=>{x(t),window.scrollTo({top:0,behavior:"smooth"})},className:`px-3 py-1 rounded-md ${o===t?"bg-primary text-white":"border border-gray-300 hover:bg-gray-100"}`,children:t},t))}),e.jsx("button",{onClick:A,disabled:o===u,className:"p-2 rounded-md border border-gray-300 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(M,{className:"h-5 w-5"})})]})]}),!d&&!n&&g.length===0&&!m&&e.jsx("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:e.jsxs("div",{className:"bg-gray-100 dark:bg-gray-800 p-8 rounded-lg max-w-md",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"No Local News Found"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"We couldn't find any local news for your current location. This could be because of limited coverage in your area."}),e.jsx("button",{onClick:()=>{a&&h(a)},className:"px-4 py-2 bg-primary text-white rounded-md hover:bg-primary/90",children:"Refresh"})]})})]})}export{V as default};

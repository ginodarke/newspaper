import{e as C,j as e,u as L,a as P,r as a}from"./index-CIYHIpx5.js";import{d as E,s as T}from"./news-oK27dgwQ.js";function M(){const{theme:o,toggleTheme:t}=C();return e.jsx("button",{onClick:t,className:"p-2 rounded-full bg-gray-100 dark:bg-gray-800 text-gray-800 dark:text-gray-200 hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors",title:o==="light"?"Switch to dark mode":"Switch to light mode",children:o==="light"?e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.752 15.002A9.718 9.718 0 0118 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 003 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 009.002-5.998z"})}):e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3v2.25m6.364.386l-1.591 1.591M21 12h-2.25m-.386 6.364l-1.591-1.591M12 18.75V21m-4.773-4.227l-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z"})})})}function I(){const o=L(),{user:t,signOut:p}=P(),[v,l]=a.useState(!0),[c,g]=a.useState(!1),[u,m]=a.useState(null),[x,h]=a.useState(null),[k,d]=a.useState(!1),[n,i]=a.useState([]),[y,b]=a.useState(""),j=["Technology","Business","Politics","Science","Health","Sports","Entertainment","World News"];a.useEffect(()=>{if(!t){o("/auth");return}(async()=>{l(!0),m(null);try{const{preferences:s,error:f}=await E(t.id);if(f)throw f;s&&(i(s.categories||[]),b(s.location||""))}catch(s){console.error("Error loading profile:",s),m("Failed to load your profile. Please try again.")}finally{l(!1)}})()},[t,o]);const w=r=>{n.includes(r)?i(n.filter(s=>s!==r)):i([...n,r])},N=async()=>{try{await p(),o("/")}catch(r){console.error("Error signing out:",r)}},S=async()=>{if(t){g(!0),h(null),d(!1);try{const{success:r,error:s}=await T(t.id,{categories:n,sources:[],location:y});if(!r)throw s;d(!0),setTimeout(()=>d(!1),3e3)}catch(r){console.error("Error saving preferences:",r),h("Failed to save your preferences. Please try again.")}finally{g(!1)}}};return v?e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-50 dark:bg-gray-900 transition-colors duration-200",children:e.jsx("div",{className:"w-12 h-12 border-t-2 border-primary border-solid rounded-full animate-spin"})}):e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 py-12 transition-colors duration-200",children:e.jsx("div",{className:"container mx-auto px-4",children:e.jsx("div",{className:"max-w-3xl mx-auto",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden transition-colors duration-200",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Your Profile"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(M,{}),e.jsx("button",{onClick:N,className:"px-4 py-2 text-sm text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300",children:"Sign Out"})]})]}),t&&e.jsx("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:t.email}),u&&e.jsx("div",{className:"mt-4 p-3 bg-red-50 dark:bg-red-900/30 text-red-500 dark:text-red-300 rounded-md",children:u})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Interests"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Select topics you're interested in to personalize your news feed."}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-8",children:j.map(r=>e.jsx("button",{onClick:()=>w(r),className:`p-3 rounded-md border text-center transition-colors ${n.includes(r)?"bg-primary text-white border-primary":"bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 border-gray-300 dark:border-gray-600 hover:border-primary dark:hover:border-primary"}`,children:r},r))}),e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Location"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Update your location to get relevant local news."}),e.jsx("div",{className:"mb-8",children:e.jsx("input",{type:"text",value:y,onChange:r=>b(r.target.value),placeholder:"City or zip code",className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"})}),x&&e.jsx("div",{className:"mt-4 mb-4 p-3 bg-red-50 dark:bg-red-900/30 text-red-500 dark:text-red-300 rounded-md",children:x}),k&&e.jsx("div",{className:"mt-4 mb-4 p-3 bg-green-50 dark:bg-green-900/30 text-green-600 dark:text-green-300 rounded-md",children:"Your preferences have been saved successfully!"}),e.jsxs("div",{className:"flex justify-end",children:[e.jsx("button",{onClick:()=>o("/feed"),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md mr-3 hover:bg-gray-50 dark:hover:bg-gray-700",children:"Cancel"}),e.jsx("button",{onClick:S,disabled:c,className:"px-4 py-2 bg-primary text-white rounded-md hover:bg-opacity-90 disabled:opacity-50 disabled:cursor-not-allowed",children:c?"Saving...":"Save Preferences"})]})]})]})})})})}export{I as default};

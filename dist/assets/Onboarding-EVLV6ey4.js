import{u as w,a as S,r as o,j as e}from"./index-CrJ8FlQI.js";import{s as L}from"./news-BjdQ78CF.js";function E(){const y=w(),{user:c}=S(),[t,d]=o.useState(1),[a,u]=o.useState([]),[r,i]=o.useState(""),[l,m]=o.useState(null),[x,h]=o.useState(!1),[p,g]=o.useState(""),f=["Technology","Business","Politics","Science","Health","Sports","Entertainment","World News"],b=s=>{a.includes(s)?u(a.filter(n=>n!==s)):u([...a,s])},j=()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(s=>{const n={latitude:s.coords.latitude,longitude:s.coords.longitude,accuracy:s.coords.accuracy};m(n),i("Location detected")},()=>{i("Location permission denied")}):i("Geolocation not supported")},N=async()=>{if(t<3)d(t+1);else{h(!0),g("");try{if(!c)throw new Error("User not authenticated");const{success:s,error:n}=await L(c.id,{categories:a,sources:[],location:l?`${l.latitude},${l.longitude}`:r});if(!s)throw n;y("/feed")}catch(s){g(s.message||"Failed to save preferences"),console.error("Error saving preferences:",s)}finally{h(!1)}}},v=()=>{t>1&&d(t-1)};return e.jsx("div",{className:"flex items-center justify-center min-h-screen p-4 bg-gray-50",children:e.jsxs("div",{className:"w-full max-w-2xl p-8 space-y-8 bg-white rounded-lg shadow-md",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Set Up Your Profile"}),e.jsxs("p",{className:"mt-2 text-gray-600",children:["Step ",t," of 3"]}),e.jsx("div",{className:"w-full bg-gray-200 h-2 mt-4 rounded-full",children:e.jsx("div",{className:"bg-primary h-2 rounded-full transition-all duration-300",style:{width:`${t/3*100}%`}})})]}),p&&e.jsx("div",{className:"p-3 text-sm text-red-500 bg-red-50 rounded-md",children:p}),t===1&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Choose Your Interests"}),e.jsx("p",{className:"text-gray-600",children:"Select topics you're interested in for personalized news."}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:f.map(s=>e.jsx("button",{onClick:()=>b(s),className:`p-3 rounded-md border text-center transition-colors ${a.includes(s)?"bg-primary text-white border-primary":"bg-white text-gray-700 border-gray-300 hover:border-primary"}`,children:s},s))})]}),t===2&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Set Your Location"}),e.jsx("p",{className:"text-gray-600",children:"This helps us deliver local news relevant to you."}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("button",{onClick:j,className:"w-full px-4 py-2 text-white bg-primary rounded-md hover:bg-opacity-90",children:"Use My Current Location"}),r&&e.jsx("div",{className:"p-3 bg-green-50 text-green-800 rounded-md",children:r}),e.jsx("div",{className:"text-center",children:e.jsx("p",{className:"text-sm text-gray-500",children:"Or"})}),e.jsx("div",{children:e.jsx("input",{type:"text",placeholder:"Enter your city or zip code",value:r==="Location detected"||r==="Location permission denied"||r==="Geolocation not supported"?"":r,onChange:s=>{m(null),i(s.target.value)},className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary"})})]})]}),t===3&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Ready to Go!"}),e.jsx("p",{className:"text-gray-600",children:"Your profile is set up and we're ready to show you personalized news that matters to you."}),e.jsxs("div",{className:"p-6 bg-gray-50 rounded-lg border border-gray-200",children:[e.jsx("h3",{className:"font-medium",children:"Your Preferences"}),e.jsxs("p",{className:"mt-2",children:[e.jsx("span",{className:"font-medium",children:"Interests:"})," ",a.join(", ")||"None selected"]}),e.jsxs("p",{className:"mt-1",children:[e.jsx("span",{className:"font-medium",children:"Location:"})," ",r||"Not specified"]})]})]}),e.jsxs("div",{className:"flex justify-between mt-8",children:[e.jsx("button",{onClick:v,className:`px-4 py-2 border border-gray-300 rounded-md ${t===1?"opacity-50 cursor-not-allowed":"hover:bg-gray-50"}`,disabled:t===1,children:"Back"}),e.jsx("button",{onClick:N,disabled:x,className:"px-4 py-2 text-white bg-primary rounded-md hover:bg-opacity-90 disabled:opacity-50 disabled:cursor-not-allowed",children:x?"Saving...":t===3?"Finish":"Next"})]})]})})}export{E as default};

import{r as o,j as t}from"./index-CIYHIpx5.js";import{M as z,u as M,P as $,a as T,b as V,L as B,m as D}from"./proxy-Dml9GGO8.js";import{b as O}from"./news-oK27dgwQ.js";class U extends o.Component{getSnapshotBeforeUpdate(s){const r=this.props.childRef.current;if(r&&s.isPresent&&!this.props.isPresent){const i=this.props.sizeRef.current;i.height=r.offsetHeight||0,i.width=r.offsetWidth||0,i.top=r.offsetTop,i.left=r.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function W({children:e,isPresent:s}){const r=o.useId(),i=o.useRef(null),m=o.useRef({width:0,height:0,top:0,left:0}),{nonce:u}=o.useContext(z);return o.useInsertionEffect(()=>{const{width:a,height:n,top:d,left:l}=m.current;if(s||!i.current||!a||!n)return;i.current.dataset.motionPopId=r;const c=document.createElement("style");return u&&(c.nonce=u),document.head.appendChild(c),c.sheet&&c.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${a}px !important;
            height: ${n}px !important;
            top: ${d}px !important;
            left: ${l}px !important;
          }
        `),()=>{document.head.removeChild(c)}},[s]),t.jsx(U,{isPresent:s,childRef:i,sizeRef:m,children:o.cloneElement(e,{ref:i})})}const _=({children:e,initial:s,isPresent:r,onExitComplete:i,custom:m,presenceAffectsLayout:u,mode:a})=>{const n=M(F),d=o.useId(),l=o.useCallback(g=>{n.set(g,!0);for(const v of n.values())if(!v)return;i&&i()},[n,i]),c=o.useMemo(()=>({id:d,initial:s,isPresent:r,custom:m,onExitComplete:l,register:g=>(n.set(g,!1),()=>n.delete(g))}),u?[Math.random(),l]:[r,l]);return o.useMemo(()=>{n.forEach((g,v)=>n.set(v,!1))},[r]),o.useEffect(()=>{!r&&!n.size&&i&&i()},[r]),a==="popLayout"&&(e=t.jsx(W,{isPresent:r,children:e})),t.jsx($.Provider,{value:c,children:e})};function F(){return new Map}const R=e=>e.key||"";function I(e){const s=[];return o.Children.forEach(e,r=>{o.isValidElement(r)&&s.push(r)}),s}const ee=({children:e,custom:s,initial:r=!0,onExitComplete:i,presenceAffectsLayout:m=!0,mode:u="sync",propagate:a=!1})=>{const[n,d]=T(a),l=o.useMemo(()=>I(e),[e]),c=a&&!n?[]:l.map(R),g=o.useRef(!0),v=o.useRef(l),y=M(()=>new Map),[w,h]=o.useState(l),[f,N]=o.useState(l);V(()=>{g.current=!1,v.current=l;for(let p=0;p<f.length;p++){const x=R(f[p]);c.includes(x)?y.delete(x):y.get(x)!==!0&&y.set(x,!1)}},[f,c.length,c.join("-")]);const b=[];if(l!==w){let p=[...l];for(let x=0;x<f.length;x++){const C=f[x],S=R(C);c.includes(S)||(p.splice(x,0,C),b.push(C))}u==="wait"&&b.length&&(p=b),N(I(p)),h(l);return}const{forceRender:j}=o.useContext(B);return t.jsx(t.Fragment,{children:f.map(p=>{const x=R(p),C=a&&!n?!1:l===f||c.includes(x),S=()=>{if(y.has(x))y.set(x,!0);else return;let A=!0;y.forEach(P=>{P||(A=!1)}),A&&(j==null||j(),N(v.current),a&&(d==null||d()),i&&i())};return t.jsx(_,{isPresent:C,initial:!g.current||r?void 0:!1,custom:C?void 0:s,presenceAffectsLayout:m,mode:u,onExitComplete:C?void 0:S,children:p},x)})})};var E=new Map,k=new WeakMap,L=0,K=void 0;function G(e){return e?(k.has(e)||(L+=1,k.set(e,L.toString())),k.get(e)):"0"}function H(e){return Object.keys(e).sort().filter(s=>e[s]!==void 0).map(s=>`${s}_${s==="root"?G(e.root):e[s]}`).toString()}function q(e){const s=H(e);let r=E.get(s);if(!r){const i=new Map;let m;const u=new IntersectionObserver(a=>{a.forEach(n=>{var d;const l=n.isIntersecting&&m.some(c=>n.intersectionRatio>=c);e.trackVisibility&&typeof n.isVisible>"u"&&(n.isVisible=l),(d=i.get(n.target))==null||d.forEach(c=>{c(l,n)})})},e);m=u.thresholds||(Array.isArray(e.threshold)?e.threshold:[e.threshold||0]),r={id:s,observer:u,elements:i},E.set(s,r)}return r}function J(e,s,r={},i=K){if(typeof window.IntersectionObserver>"u"&&i!==void 0){const d=e.getBoundingClientRect();return s(i,{isIntersecting:i,target:e,intersectionRatio:typeof r.threshold=="number"?r.threshold:0,time:0,boundingClientRect:d,intersectionRect:d,rootBounds:d}),()=>{}}const{id:m,observer:u,elements:a}=q(r),n=a.get(e)||[];return a.has(e)||a.set(e,n),n.push(s),u.observe(e),function(){n.splice(n.indexOf(s),1),n.length===0&&(a.delete(e),u.unobserve(e)),a.size===0&&(u.disconnect(),E.delete(m))}}function te({threshold:e,delay:s,trackVisibility:r,rootMargin:i,root:m,triggerOnce:u,skip:a,initialInView:n,fallbackInView:d,onChange:l}={}){var c;const[g,v]=o.useState(null),y=o.useRef(l),[w,h]=o.useState({inView:!!n,entry:void 0});y.current=l,o.useEffect(()=>{if(a||!g)return;let j;return j=J(g,(p,x)=>{h({inView:p,entry:x}),y.current&&y.current(p,x),x.isIntersecting&&u&&j&&(j(),j=void 0)},{root:m,rootMargin:i,threshold:e,trackVisibility:r,delay:s},d),()=>{j&&j()}},[Array.isArray(e)?e.toString():e,g,m,i,u,a,r,d,s]);const f=(c=w.entry)==null?void 0:c.target,N=o.useRef(void 0);!g&&f&&!u&&!a&&N.current!==f&&(N.current=f,h({inView:!!n,entry:void 0}));const b=[v,w.inView,w.entry];return b.ref=b[0],b.inView=b[1],b.entry=b[2],b}function Q({size:e="medium"}){const r={small:"w-5 h-5",medium:"w-8 h-8",large:"w-12 h-12"}[e];return t.jsxs("div",{className:"flex flex-col items-center justify-center",children:[t.jsx("div",{className:`${r} animate-spin rounded-full border-4 border-blue-200 border-t-blue-600 dark:border-gray-700 dark:border-t-blue-500`}),e==="large"&&t.jsx("p",{className:"mt-3 text-gray-600 dark:text-gray-400",children:"Loading content..."})]})}function re({article:e,onSave:s,onShare:r,onClick:i}){const[m,u]=o.useState("article"),[a,n]=o.useState(null),[d,l]=o.useState(!1),[c,g]=o.useState(null),v=async h=>{if(u(h),h==="ai"&&!a&&!d)try{l(!0),g(null);const f=await O(e);n(f)}catch(f){console.error("Error getting AI summary:",f),g("Failed to get AI summary. Please try again later.")}finally{l(!1)}},y=(h,f)=>h?h.length>f?h.substring(0,f)+"...":h:"",w=e.publishedAt?new Date(e.publishedAt).toLocaleDateString():"Recently";return t.jsxs("div",{className:"h-full flex flex-col overflow-hidden hover:shadow-lg transition-shadow duration-300 cursor-pointer border rounded-lg bg-card text-card-foreground shadow",onClick:i,children:[t.jsxs("div",{className:"py-4 px-5 border-b",children:[t.jsxs("div",{className:"flex justify-between items-start mb-2",children:[t.jsx("div",{className:"bg-primary/10 text-primary text-xs rounded-full px-2 py-1",children:e.source||"News"}),t.jsx("span",{className:"text-sm text-muted-foreground",children:w})]}),t.jsx("h3",{className:"text-lg font-bold leading-tight line-clamp-2 hover:text-primary transition-colors",children:e.title})]}),e.imageUrl&&t.jsx("div",{className:"aspect-video relative overflow-hidden",children:t.jsx("img",{src:e.imageUrl,alt:e.title,className:"object-cover w-full h-full transform hover:scale-105 transition-transform duration-300",onError:h=>{const f=h.target;f.style.display="none"}})}),t.jsx("div",{className:"flex-grow p-4",children:t.jsxs("div",{className:"w-full mb-2",children:[t.jsxs("div",{className:"grid w-full grid-cols-2 mb-2 border rounded-lg overflow-hidden",children:[t.jsx("button",{className:`py-2 text-center text-sm ${m==="article"?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground"}`,onClick:()=>v("article"),children:"Article"}),t.jsx("button",{className:`py-2 text-center text-sm ${m==="ai"?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground"}`,onClick:()=>v("ai"),children:"AI Summary"})]}),t.jsxs("div",{className:"mt-2 min-h-[80px]",children:[m==="article"&&t.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 line-clamp-3",children:e.description||"No description available"}),m==="ai"&&t.jsx(t.Fragment,{children:d?t.jsx("div",{className:"flex items-center justify-center py-4",children:t.jsx(Q,{size:"small"})}):c?t.jsx("div",{className:"text-sm text-red-500 py-2",children:c}):a?t.jsx(D.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:t.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:y(a,180)})}):t.jsx("p",{className:"text-sm text-gray-500 italic",children:"Click to generate AI summary"})})]})]})}),t.jsxs("div",{className:"flex justify-between items-center py-3 px-5 border-t",children:[s&&t.jsxs("button",{className:"inline-flex items-center px-3 py-1 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-200 dark:hover:bg-gray-700",onClick:h=>{h.stopPropagation(),s(e.id)},children:[t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mr-1",children:t.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),"Save"]}),r&&t.jsxs("button",{className:"inline-flex items-center px-3 py-1 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-200 dark:hover:bg-gray-700",onClick:h=>{h.stopPropagation(),r(e.id)},children:[t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mr-1",children:[t.jsx("circle",{cx:"18",cy:"5",r:"3"}),t.jsx("circle",{cx:"6",cy:"12",r:"3"}),t.jsx("circle",{cx:"18",cy:"19",r:"3"}),t.jsx("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),t.jsx("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})]}),"Share"]})]})]})}export{ee as A,Q as L,re as a,te as u};
